<main-layout-default>
  <ng-container ngProjectAs="menu">

    <mat-expansion-panel class="instance-switcher no-padding arrow-colored">
      <mat-expansion-panel-header class="switcher-toggle" *ngIf="(selectedIdentity | async) as selectedId">
        <div class="item">
          <!-- TODO: offer various colors for wallets/whatever to easily tell them apart? -->
          <div class="icon">{{ selectedId.icon }}</div>
          <div class="name">{{ selectedId.displayName }}</div>
          <div class="value">{{ currentBalance | async}} PART</div>
        </div>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div class="options">
          <a class="item" *ngFor="let identity of otherIdentities | async;trackBy:trackByIdentityFn" (click)="identitySelected(identity)" (keyup.enter)="identitySelected(identity)" tabindex="0">
            <div class="icon">{{ identity.icon }}</div>
            <div class="name">{{ identity.displayName }}</div>
            <div class="value">Switch Identity</div>
          </a>
        </div>
      </ng-template>

    </mat-expansion-panel>

    <div class="menu-items">
      <ng-container *ngFor="let menuItem of menu; trackBy:trackByMenuFn">
        <ng-container *ngIf="(isStarted || menuItem.alwaysEnabled); else menuDeactivated">
          <a class="menu-item" routerLinkActive="active" [routerLink]="menuItem.path">
            <ng-container *ngIf="menuItem.icon.length > 0">
              <mat-icon [fontIcon]="menuItem.icon"></mat-icon>
            </ng-container>
            <span class="text">{{menuItem.text}}</span>
          </a>
        </ng-container>

        <ng-template #menuDeactivated>
          <a class="menu-item disabled" routerLinkActive="" [routerLink]="null">
            <ng-container *ngIf="menuItem.icon.length > 0">
              <mat-icon [fontIcon]="menuItem.icon"></mat-icon>
            </ng-container>
            <span class="text">{{menuItem.text}}</span>
          </a>
        </ng-template>
      </ng-container>
    </div>

  </ng-container>

  <main-topbar></main-topbar>

  <!-- Alpha mainnet warning -->
  <div class="notification" fxLayout fxLayoutAlign="space-between center" *ngIf="isWarningVisible">
    <div class="text">
      <mat-icon fontIcon="part-circle-info"></mat-icon>
      The Particl Marketplace is still in development - use it at your own risk!
    </div>
    <div class="buttons">
      <button class="button" mat-button color="warn" (click)="openWarningMessage()">
        <mat-icon fontIcon="part-alert"></mat-icon>
        Click here to read all the details first!
      </button>
      <button class="button tiny icon-only" mat-button matTooltip="Dismiss for this session" (click)="isWarningVisible=false;">
        <mat-icon fontIcon="part-cross"></mat-icon>
      </button>
    </div>
  </div><!-- .notification -->

  <router-outlet></router-outlet>
</main-layout-default>
