<mat-dialog-title>Join Existing Market</mat-dialog-title>
<button mat-button color="warn" class="modal-close" mat-dialog-close tabindex="-1">
  <mat-icon fontIcon="part-cross"></mat-icon>
</button>


<mat-dialog-content>
  <div class="row">

    <form class="market-form" [formGroup]="marketForm">

      <h2 class="section-title">
        Market details
      </h2>

      <mat-card class="market-details">

        <label>
          <mat-form-field class="--larger --plain" appearance="fill">
            <h3 class="label">Market name</h3>
            <input matInput #name placeholder="Choose a name for your Market" formControlName="name">
            <mat-hint align="end">{{ name.value.length }}/{{ MAX_NAME }}</mat-hint>
          </mat-form-field>
        </label>

        <label>
          <mat-form-field class="--larger --plain" appearance="fill">
            <h3 class="label">Market description</h3>
            <textarea matInput rows="4" #description formControlName="summary" placeholder="Describe your Market in short, so that users will know what they'll find there"></textarea>
            <mat-hint align="end">{{ description.value.length }}/{{ MAX_SUMMARY }}</mat-hint>
          </mat-form-field>
        </label>

        <div class="market-image" fxLayout>
          <div #dropArea class="drag-n-drop" fxFlex="130px">
            <input class="hide-file" type="file" accept="image/*" #fileInputSelector>
            <button mat-button color="accent" (click)="addImage()" class="small">
              Add a personalized logo
            </button>
            <p>or drag'n'drop here</p>
          </div>
          <div class="desc" fxFlex="0 1 100%">
            <h3 class="box-title">Market logo/image</h3>
            <p>Add a Market logo/photo for customized branding</p>
            <ul>
              <li>Square format only</li>
              <li>Recommended resolution 300 Ã— 300 px</li>
              <li>Max size 2 MB</li>
            </ul>
          </div>

          <div class="gallery">

            <div class="photo-wrapper" *ngIf="formImageControl.value.length > 0">
              <img [src]="formImageControl.value">
              <div class="icons">
                <mat-icon class="delete" fontIcon="part-cross" matTooltip="Remove image" (click)="formImageControl.setValue('')">
                </mat-icon>
              </div>
            </div>
          </div><!-- .gallery -->
        </div>

      </mat-card><!-- market details -->

      <!-- @TODO: The market type and the ID/key input should probably be first in this modal, followed by name and then all the optional inputs (description, image, region, etc) -->

      <h2 class="section-title">
        Market ID and Access/Publish Key
      </h2>

      <mat-card class="market-type">
        <label>
          <mat-form-field class="--larger --plain" appearance="fill">
            <h3 class="label">Market ID</h3>
            <input matInput placeholder="Market ID of the market to be joined" formControlName="keyReceive">
          </mat-form-field>
        </label>

        <label>
          <mat-form-field class="--larger --plain" appearance="fill">
            <h3 class="label">Access/Publish key</h3>
            <input matInput placeholder="Market Key of the market to be joined" formControlName="keyPublish">
          </mat-form-field>
        </label>

      </mat-card><!-- market type -->


      <h2 class="section-title">
        Optional Market Region
      </h2>

      <mat-card fxLayout fxLayoutGap="30px" class="market-type">
        <mat-select placeholder="Filter by Market" formControlName="region">
          <mat-option *ngFor="let option of optionsMarketRegions" [value]="option.value">
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-card><!-- market region -->

    </form>

  </div>
</mat-dialog-content>


<mat-dialog-actions>
  <button mat-button mat-dialog-close>
    <mat-icon fontIcon="part-cross"></mat-icon>
    Close
  </button>
  <button mat-raised-button color="warn" [disabled]="marketForm.invalid || marketForm.disabled" appDebounceClick (debounceClick)="doAction()">
    <mat-icon fontIcon="part-circle-plus"></mat-icon>
    Join Existing Market
  </button>
</mat-dialog-actions>
