<div class="cold-staking section">
  <header>
    <div class="subtitle">Cold Staking</div>
  </header>

  <ng-container *ngTemplateOutlet="(walletName | async) === null ? disabled : enabled"></ng-container>

</div><!-- .cold-staking -->

<ng-template #disabled>
  <mat-card class="staking-node inactive">
    <div class="title">Cold Staking Node</div>
    <div class="subtitle">Wallet currently unavailable</div>
  </mat-card>
</ng-template>


<ng-template #enabled>
  <ng-container *ngIf="(isActivated | async); else isDeactivated">

    <mat-card *ngIf="isUnlocked || (coldStakePercent === 100)" class="staking-node active">
      <div class="title">Cold Staking Node</div>
      <div class="subtitle in-progress">
        <span *ngIf="coldStakePercent < 100">Activation in progress</span>
        <span *ngIf="coldStakePercent === 100">Activated</span>
        <span class="progress">{{coldStakePercent}}%</span>
      </div>
      <mat-progress-bar
        class="progress-bar"
        [color]="'primary'"
        [bufferValue]="coldStakePercent"
        [mode]="'determinate'"
        [value]="coldStakePercent">
      </mat-progress-bar>
      <p class="buttons">
        <button mat-button *ngIf="coldStakePercent < 100" class="small" color="primary" matTooltip="Fast-forward to 100%" (click)="zap()" [disabled]="isProcessing">
          Zap
        </button>
        <button mat-button class="small" color="warn" matTooltip="Disable Cold Staking" (click)="revert()" [disabled]="isProcessing">
          Disable
        </button>
      </p>
    </mat-card>

    <p class="widget-help">
      {{coldStakePercent}}% of your balance is now cold staking.
      <ng-template *ngIf="(coldStakePercent < 100) && !isUnlocked">The activation process will continue only when your wallet is online and unlocked for staking.</ng-template>
    </p>

    <!-- if wallet is locked, & under < 100% progress -->
    <mat-card *ngIf="coldStakePercent < 100 && !isUnlocked" class="staking-node warning">
      <div class="title">Cold Staking Node</div>
      <div class="subtitle in-progress">
        <strong>Paused</strong> &ndash; Wallet locked
        <span class="progress">{{coldStakePercent}}%</span>
      </div>
      <mat-progress-bar
        class="progress-bar"
        [color]="'warn'"
        [bufferValue]="coldStakePercent"
        [mode]="'determinate'"
        [value]="coldStakePercent">
      </mat-progress-bar>
      <p class="widget-help">
        The cold staking activation is paused. Unlock wallet for staking to continue the process.
        Whilst paused, {{coldStakePercent}}% of your balance that has already converted
        will continue to stake on your staking node.
      </p>
      <p class="buttons">
        <button mat-button class="small" color="primary"
          matTooltip="Fast-forward to 100%"
          (click)="zap()"
          [disabled]="isProcessing"
          *ngIf="coldStakePercent < 100">
          Zap
        </button>
        <button mat-button class="small" color="warn"
          matTooltip="Disable Cold Staking"
          (click)="revert()"
          [disabled]="isProcessing">
          Disable
        </button>
      </p>
    </mat-card>

  </ng-container>
</ng-template>


<ng-template #isDeactivated>
  <mat-card class="staking-node inactive">
    <button mat-raised-button color="primary" (click)="openColdStakeModal()" matTooltip="Add Cold Staking node key">
      <mat-icon fontSet="partIcon" fontIcon="part-plus"></mat-icon>
    </button>
    <div class="title">Cold Staking Node</div>
    <div class="subtitle">Inactive</div>
  </mat-card>

  <p class="widget-help">
    Cold staking allows you to spend from one machine and stake from another, this greatly increases the safety of your coins.
  </p>
</ng-template>
