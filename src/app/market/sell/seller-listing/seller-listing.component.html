<mat-expansion-panel class="listing list-item no-padding">
  <mat-expansion-panel-header class="header">
    <div class="header-wrapper" fxLayout="row" fxLayoutAlign="space-between center">
      <div class="photo" fxFlex="0 0 90px">
        <img src="{{ listing?.imageCollection?.featuredImage?.medium}}">
      </div>
      <div class="meta" fxFlex="1 1 100%">
        <div class="name">{{ listing?.title }}</div>
        <!-- TODO: if published on 1 market, display it's name; if on multiple display "X Markets" (as shown below) -->
        <span class="published-markets">2 Markets</span>
        <span class="category">{{ listing?.category.name }}</span>
      </div>
      <div *ngFor="let status of getStatus(listing?.status)">
        <div class="status {{ status?.class }}" fxFlex="0 0 140px"><span class="dot"></span>{{ status?.status }}</div>
      </div>
    </div>
  </mat-expansion-panel-header>

  <div class="status-info">
    <p>{{ listing?.shortDescription }}</p>
  </div>

  <div class="detail" fxLayout="row" fxLayoutGap="30px">
    <div class="description" fxFlex="55%">
      <div class="title">Listing info</div>
      <table class="listing-info">
        <tr>
          <th>Category</th>
          <td>{{ listing?.category.name }}</td>
        </tr>
        <tr>
          <th>Created</th>
          <td>{{ listing?.createdAt }}</td>
        </tr>
        <tr>
          <th>Expires</th>
          <td>{{ listing?.expiredAt }}</td>
        </tr>
        <tr>
          <th>Published&nbsp;on</th>
          <!-- TODO: list all Markets where the Listing was published (just wrapping each in `.published-market` is enough, CSS will display them 1 per line) -->
          <td>
            <span class="published-market">Particl Open Marketplace</span>
            <span class="published-market">Sneaky Market</span>
          </td>
        </tr>
      </table>
    </div><!-- .description -->
    <div class="info" fxFlex="45%">
      <div class="title">Price</div>
      <table class="prices">
        <!--tr><th>Quantity</th><td>2</td></tr-->
        <tr>
          <th>Price per item</th>
          <td>{{ listing?.basePrice.particlsString() }} <small>PART</small></td>
        </tr>
        <tr>
          <th>Shipping price</th>
          <td>
            Local in {{ listing?.country }} &ndash; {{ listing?.domesticShippingPrice.particlsString() }} <small>PART</small><br>
            Worldwide &ndash; {{ listing?.internationalShippingPrice.particlsString() }} <small>PART</small>
          </td>
        </tr>
      </table>
    </div>
  </div>

  <mat-action-row fxLayout fxLayoutAlign="space-between stretch">
    <div class="left">
      <button mat-button color="warn" matTooltip="Delete listing" *ngIf="listing?.isUnpublished" (click)="confirmDeleteListing(listing)"
              class="small">
        <mat-icon fontSet="partIcon" fontIcon="part-cross"></mat-icon>
      </button>
      <button mat-button matTooltip="Clone listing" (click)="addItem(listing?.id, true)" class="small">
        <mat-icon fontSet="partIcon" fontIcon="part-copy"></mat-icon>
      </button>
      <button mat-button matTooltip="Edit listing details" *ngIf="listing?.isUnpublished" (click)="addItem(listing?.id)" class="small">
        <mat-icon fontSet="partIcon" fontIcon="part-pen-1"></mat-icon>
        Edit listing
      </button>
    </div>
    <div class="right" *ngFor="let status of getStatus(listing?.status)">
      <button mat-raised-button color="{{ status?.action_color }}" matTooltip="{{ status?.action_tooltip }}" (click)="action(listing)" [disabled]="status?.action_disabled">
        <!-- listing.action_disabled -->
        <mat-icon fontSet="partIcon" fontIcon="{{ status?.action_icon }}"></mat-icon>
        {{ status?.action_button }}
      </button>
    </div>
  </mat-action-row>
</mat-expansion-panel><!-- .listing -->
