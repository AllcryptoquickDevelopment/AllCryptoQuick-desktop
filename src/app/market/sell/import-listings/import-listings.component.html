<mat-tab-group (selectedTabChange)="tabChange($event);" animationDuration="0ms">
  <mat-tab *ngFor="let import of filterByNetwork" label="{{import.name}}">
    <div class="container-block">

      <h2 class="subtitle">Import product file</h2>
      <mat-card [formGroup]="import.form" [ngSwitch]="import.id" class="import-file">
        <ng-container *ngSwitchCase="'csv-import'">
          <app-import-custom-ui-csv [import]="import" (clear)="clearOldValues()"></app-import-custom-ui-csv>
        </ng-container>

        <ng-container *ngSwitchCase="'woocommerce-import'">
          <app-import-custom-ui-woocommerce [import]="import" (clear)="clearOldValues()"></app-import-custom-ui-woocommerce>
        </ng-container>

        <ng-container *ngSwitchCase="'ebay-testnet-scraper'">
          <app-import-custom-ui-ebay-scraper [import]="import" (clear)="clearOldValues()"></app-import-custom-ui-ebay-scraper>
        </ng-container>

        <ng-container *ngSwitchDefault>
          <h3 class="box-title">{{import.description}}</h3>
          <div *ngFor="let param of import.params" [ngSwitch]="param.type">
            <mat-form-field *ngSwitchCase="'text'"
                            [formGroup]="import.form">
              <input matInput [formControlName]="param.name" [placeholder]="param.message" [type]="param.type" (change)="clearOldValues()">
            </mat-form-field>

            <mat-form-field *ngSwitchCase="'number'"
                            [formGroup]="import.form">
              <input matInput min="0" (paste)="numericValidator($event)" (keypress)="numericValidator($event)" 
                    [formControlName]="param.name" [placeholder]="param.message" (change)="clearOldValues()"
                    type="text">
            </mat-form-field>

            <mat-form-field *ngSwitchCase="'file'"
                            [formGroup]="import.form">
              <ngx-mat-file-input [formControlName]="param.name" [placeholder]="param.message" [accept]="param.fileType" (change)="clearOldValues()"></ngx-mat-file-input>
            </mat-form-field>
          </div>
        </ng-container>
    
        <span *ngIf="importError">{{ importError }}</span>
    
        <div class="action-buttons" fxLayout fxLayoutAlign="end center">
          <button [disabled]="!import.form.valid" 
                  mat-raised-button
                  color="primary"
                  matTooltip="Load listings"
                  (click)="importLoad(import)">
            <mat-icon fontSet="partIcon" fontIcon="part-image-upload"></mat-icon>
            Load products
          </button>
        </div><!-- .action-buttons -->
      </mat-card>

    </div>
  </mat-tab>
</mat-tab-group>


<div class="container-block">
  <mat-accordion *ngIf="listings.length > 0">
    <h2 class="subtitle">Products found for import</h2>
    <p>Based on your product file, we've found these Products for import. Review and update their missing information, like shipping prices and categories.</p>
    <app-import-listing *ngFor="let listing of listings" [listing]="listing" (onChange)="clearEstimate()"></app-import-listing>
  </mat-accordion> 
</div>


<div class="container-block" *ngIf="canPublish">
  <h2 class="subtitle">Shipping &amp; Listing expiration</h2>
  <mat-card>
    <h3 class="box-title">Shipping</h3>
    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="30px">

      <mat-select-search
        fxFlex="1 1 30%"
        class="full-width"
        [options]="countryList.getList()"
        [showValueOf]="'name'"
        [placeHolder]="'Shipping from (your country)'"
        [isRequired]="'true'"
        [isLexigraphicalOrder]="true"
        [defaultSelectedValue]="selectedCountry"
        (onChange)="onCountryChange($event)">
      </mat-select-search>
      <div class="desc" fxFlex="1 1 70%">
        <p>
          Select your country, from which you will ship your products.
        </p>
        <p class="widget-help">
          Domestic shipping rate will apply for selected country. For all other countries, international shipping rates will be applied.
        </p>
      </div><!-- .desc -->

    </div>

    <h3 class="box-title">Listing expiration &amp; fees</h3>
    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="30px">

      <mat-form-field class="full-width" fxFlex="1 1 30%">
        <mat-label>Select expiry time</mat-label>
        <mat-select [(value)]="selectedExpiration" (selectionChange)="clearEstimate()">
          <mat-option>None</mat-option>
          <mat-option [disabled]="expire?.isDisabled" *ngFor="let expire of expiredList" [value]="expire.value">
            {{ expire.title }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div class="desc" fxFlex="1 1 70%">
        <p>
          How long should the imported Listings be published on the Open Marketplace?
        </p>
        <p class="widget-help">
          Listing(s) publishing fee increases linearly for each published day. After this period, Listings will expire and you will need to re-publish them again.
        </p>
      </div><!-- .desc -->

    </div>
  </mat-card>


  <div class="action-buttons" fxLayout fxLayoutGap="30px" fxLayoutAlign="end center">
    <button *ngIf="!currentestimateFee"
            [disabled]="!selectedCountry && !selectedExpiration"
            mat-raised-button
            color="accent"
            matTooltip="Get estimate fee"
            (click)="estimateFee()">
      <mat-icon fontSet="partIcon" fontIcon="part-stake"></mat-icon>
      Estimate Fee
    </button>

    <div class="fee-info" *ngIf="!!currentestimateFee">
      Publishing fee for <!-- FIXME! --> 3 Listings / <!-- FIXME! --> 1 day(s):
      <strong>
        <span class="big">{{ currentestimateFee.getIntegerPart() }}</span>
        <span *ngIf="currentestimateFee.ifDotExist()">
          <span class="point">.</span>
          <span class="small">{{ currentestimateFee.getFractionalPart() }}</span>
        </span>
      </strong>
      <span class="currency">&ensp;PART</span>
    </div>

    <button *ngIf="!!currentestimateFee" 
            mat-raised-button
            color="primary"
            matTooltip="Publish listings"
            (click)="publishListing()">
      <mat-icon fontSet="partIcon" fontIcon="part-check"></mat-icon>
      Import &amp; Publish Listings
    </button>
  </div><!-- .action-buttons -->


</div><!-- mat-tab-group -->
